(function(n){var l,r,o,s,v;function f(e){r=e,u()}function u(){const e=r.getValue();e.host&&e.id?(o.html('<a href="'+m(e)+'" class="ss-ui-dialog-link"><img src="'+h(e)+'" alt="Preview"></a>'),o.addClass("goldfinchvideo__preview--display")):o.removeClass("goldfinchvideo__preview--display")}function h(e){let t;return e.host=="youtube"?t="https://img.youtube.com/vi/"+e.id+"/sddefault.jpg":e.host=="vimeo"&&(t="https://vumbnail.com/"+e.id+"_large.jpg"),t}function m(e){let t;return e.host=="youtube"?t="https://www.youtube.com/embed/"+e.id:e.host=="vimeo"&&(t="https://player.vimeo.com/video/"+e.id),t}function w(e,t){var i,d;if(e.search("youtube.com/")>=0||e.search("youtu.be/")>=0?(i="youtube",d=g(e)):e.search("vimeo.com/")>=0&&(i="vimeo",d=p(e)),i&&d){const a=r||(window.jsoneditor?window.jsoneditor[t]:null);if(a){var c=a.getValue();c.host=i,c.id=d,a.setValue(c),u()}}}function g(e){return e=e.split(/(vi\/|v%3D|v=|\/v\/|youtu\.be\/|\/embed\/)/),e[2]!==void 0?e[2].split(/[^0-9a-z_\-]/i)[0]:e[0]}function p(e){let t=/(https?:\/\/)?(www\.)?(player\.)?vimeo\.com\/?(showcase\/)*([0-9))([a-z]*\/)*([0-9]{6,11})[?]?.*/,i=e.match(t);if(i&&i.length==7)return i[6]}n(document).ready(()=>{let e=0;var t=setInterval(()=>{e++;const i=window.jsoneditor?window.jsoneditor[l]:null;i&&(clearInterval(t),f(i)),e>5&&clearInterval(t)},500)}),n(".cms-edit-form").entwine({onmatch(e){this._super(e)},onunmatch(e){this._super(e)},onaftersubmitform(e,t){o=n(this).find("[data-goldfinch-video-preview]"),u()}}),n.entwine("ss",e=>{e("[data-goldfinch-video-field]").entwine({onmatch(){v=e(this).find("[data-goldfinch-video-link-detector]"),o=e(this).find("[data-goldfinch-video-preview]"),s=e(this).find(".json-editor").next(),l=s.attr("id"),v.on("keyup",i=>{w(i.target.value,s.attr("id"))})}})})})(jQuery);
