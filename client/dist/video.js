(function(d){var u,o,r,c,f=[];function m(){s()}function s(e){if(e||n(),o=jQuery(e.element.closest("[data-goldfinch-video-field]").querySelector("[data-goldfinch-video-preview]")),e){const t=e.getValue();t.host&&t.id?(o.html('<a href="'+p(t)+'" class="ss-ui-dialog-link"><img src="'+g(t)+'" alt="Preview"></a>'),o.addClass("goldfinchvideo__preview--display")):o.removeClass("goldfinchvideo__preview--display")}}function g(e){let t;return e.host=="youtube"?t="https://img.youtube.com/vi/"+e.id+"/mqdefault.jpg":e.host=="vimeo"&&(t="https://vumbnail.com/"+e.id+"_large.jpg"),t}function p(e){let t;return e.host=="youtube"?t="https://www.youtube.com/embed/"+e.id:e.host=="vimeo"&&(t="https://player.vimeo.com/video/"+e.id),t}function w(e,t){var i,a;if(e.search("youtube.com/")>=0||e.search("youtu.be/")>=0?(i="youtube",a=y(e)):e.search("vimeo.com/")>=0&&(i="vimeo",a=b(e)),i&&a){const l=n(t.getAttribute("data-field-id"));if(l){var v=l.getValue();v.host=i,v.id=a,l.setValue(v),s(l)}}}function y(e){return e=e.split(/(vi\/|v%3D|v=|\/v\/|youtu\.be\/|\/embed\/)/),e[2]!==void 0?e[2].split(/[^0-9a-z_\-]/i)[0]:e[0]}function b(e){let t=/(https?:\/\/)?(www\.)?(player\.)?vimeo\.com\/?(showcase\/)*([0-9))([a-z]*\/)*([0-9]{6,11})[?]?.*/,i=e.match(t);if(i&&i.length==7)return i[6]}function h(e){m()}function n(e){return window.jsoneditor?window.jsoneditor[e]:null}function I(){f.map((e,t)=>{e.previewInit||(s(n(e.id)),f[t].previewInit=!0)})}d(document).ready(()=>{let e=0;var t=setInterval(()=>{e++,n()&&(clearInterval(t),h()),e>5&&clearInterval(t)},500)}),d(".cms-edit-form").entwine({onmatch(e){this._super(e)},onunmatch(e){this._super(e)},onaftersubmitform(e,t){o=d(this).find("[data-goldfinch-video-preview]"),h(n()),s()}}),d.entwine("ss",e=>{e("[data-goldfinch-video-field]").entwine({onmatch(){r=e(this).find(".json-editor").next(),c=r.closest("[data-goldfinch-video-field]").find("[data-goldfinch-video-link-detector]"),o=r.closest("[data-goldfinch-video-field]").find("[data-goldfinch-video-preview]"),u=r.attr("id"),c[0].setAttribute("data-field-id",u),f.push({id:u,previewInit:!1}),setTimeout(()=>I(),500),c.on("keyup",i=>{w(i.target.value,i.target)})}})})})(jQuery);
